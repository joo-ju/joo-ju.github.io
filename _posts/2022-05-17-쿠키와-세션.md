---
layout: post
title: 쿠키와 세션
subtitle:
categories: Web
tags: [cs, 쿠키, 세션, 기술면접]
---

### 사전 지식

---

#### HTTP 정의

인터넷 상에서 데이터를 주고 받기 위해 서버 및 클라이언트 모델을 따르는 통신 규약입니다.

#### HTTP 특징

- **비연결성 | Connectionless**<br>
  클라이언트가 서버에 요청을 했을 떄, 그 요청에 맞는 응답을 보낸 후 연결을 끊는 처리방식
- **비상태성 | Sateless**<br>
  클리아언트와 서버의 연결을 유지하지 않으며 이때 상태정보가 저장되지 않음

<br>

### 쿠키

---

#### 쿠키의 개념

웹 사이트에 접속 할 때 생성되는 정보를 담은 임시 파일입니다.<br>
서버가 사용자의 웹 브라우저에 저장하는 데이터를 이야기하며 데이터 형태는 Key와 Value이고 모두 string으로 이루어져 있습니다.

#### 쿠키의 특징

이름, 값, 만료일(저장기간), 경로정보 로 이루어져 있습니다. <br>
로컬 PC에 최대 300개의 쿠키를 저장할 수 있습니다.<br>
각 도메인당 최대 20개의 쿠키를 저장 할 수 있습니다.<br>
사용자의 요청이 없어도 브라우저가 요청하면 request header에 넣어 자동으로 서버에게 전달합니다.<br>
각 쿠키는 4KB 까지 저장 할 수 있습니다.<br>

※ 단, 쿠키는 브라우저별로 저장되기 떄문에 서로 공유할 수 없습니다.(크롬에 저장된 쿠키는 Edge에서 사용 불가)

#### 쿠키의 사용 목적

**세션 관리 | Session Management**<br>
닉네임, 접속 시간, 장바구니 등 서버가 알아야할 정보를 저장합니다.<br>
**개인화 | Personalization**<br>
사용자마다 다른 정보를 이용하여 개인에 맞춰 페이지를 보여줄 수 있습니다.<br>
**트래킹 | Tracking**<br>
사용자의 행동과 패턴을 분석하고 기록합니다.<br>

#### 쿠키의 단점

행동과 패턴에 대한 정보와 개인 정보가 저장되기 때문에 사생활 침해의 가능성이 있습니다.(웹 브라우저 자체에 쿠키 거부 기능이 있기 때문에 기록을 중단할 수 있음.)<br>
사용자 개인의 로컬 pc에 저장되기 떄문에 수정과 삭제가 용이합니다. 하지만 외부에 노출되기도 쉬워 보안이 취약합니다. 따라서 쿠키에는 노출되기 민감한 정보는 담지 않는 것이 좋습니다.

#### 쿠키의 동작 순서

1. 클라이언트가 페이지를 요청합니다.(웹 사이트에 접근)
2. 웹 서버가 쿠키를 생성합니다.
3. 생성한 쿠키에 정보를 담아 HTTP 화면을 돌려줄 때, 같이 클라이언트에 돌려줍니다.
4. 넘겨 받은 쿠키는 로컬 PC에 저장하고 다시 서버에 요청할 떄 요청과 함께 쿠키를 전송합니다.
5. 동일 사이트 재방문 시 로컬 PC에 저장된 쿠키가 있는 경우 요청 페이지와 함께 쿠키를 전송합니다.

<br>

### 세션

---

#### 세션의 개념

사용자가 웹 서버에 접속하여 있는 상태를 하나의 단위로 하여 세션이라고 합니다.
접속하여 있는 상태란 웹 브라우저를 통해 웹 서버에 접속한 시간부터 웹 브라우저를 종료하는 시점까지를 이야기 합니다.
웹 서버에 클라이언트에 대한 정보를 저장하고 클라이언트에게 클라이언트를 구분할 수 있는 session-id를 부여합니다.

#### 세션의 특징

session-id는 웹 브라우저당 1개씩 생성되며 브라우저 종료시 소멸됩니다.<br>
세션에 담겨있는 정보는 요청이 있을 때마다 데이터베이스에 접근하지 않아도 되므로 효율적입니다.<br/>
서버에 저장하기 때문에 용량 제한이 없습니다.<br/>
브라우저 종료, 서버에서 직접 삭제 했을 때 세션이 삭제되므로 쿠키보다 보안성이 높습니다.

#### 세션 사용 예시

화면 이동시 로그아웃 되지 않고 로그인 유지

#### 세션의 단점

서버에 데이터를 저장하기 때문에 서버 자원에 한계가 발생합니다. 뿐만아니라 메모리를 사용하기 때문에 속도 저하되기도 합니다.

#### 세션의 동작 순서

1. 클라이언트가 페이지를 요청합니다.
2. 서버는 클라이언트의 request header의 cookie 필드를 확인해 클라이언트가 session-id를 보냈는지 확인합니다.
3. session-id가 존재하지 않는다면 서버는 이를 생성하여 클라이언트에게 알려줍니다.
4. 클라이언트는 이때 받은 session-id를 쿠키를 사용해 서버에 저장합니다.
5. 클라이언트는 재접속 시에 session-id를 서버에 전달하여 상태정보를 서버가 사용할 수있도록 합니다.

※ 세션을 통해 클라이언트의 정보를 서버에 저장하고, 세션 아이디를 이용하여 인증받고 정보를 사용하는 방식입니다.

<br>

### 쿠키와 세션 비교

---

|               | 쿠키                                                        | 세션        |
| ------------- | ----------------------------------------------------------- | ----------- |
| 저장 위치     | 클라이언트<br>(로컬 PC)                                     | 서버        |
| 저장 형식     | text 형식                                                   | object 형식 |
| 사용되는 자원 | 클라이언트에 저장                                           | 서버에 저장 |
| 용량 제한     | 도메인당 최대 20개<br>쿠키당 4KB                            | 제한 없음   |
| 만료 시점     | 쿠키 저장할 때 결정<br>(설정 안하면 브라우저 종료시 만료됨) | 알 수 없음  |
| 속도          | 빠름                                                        | 비교적 느림 |

<br>

### 쿠키를 사용하는 이유

---

세션은 서버에 저장되기 때문에 자원에 한계가 존재하고 속도 저하도 우려되므로 쿠키와 세션을 적절히 기능에 맞춰 병행 사용 하는 것이 리소스를 보다 효율적으로 사용하고 속도를 높이기 때문입니다.

<br>

### 캐시(Cache)와의 차이점

---

캐시는 `웹페이지의 요소`를 저장하기 위한 임시 저장소이고 쿠키와 세션은 `정보`를 저장하는 것입니다. <br>
캐시는 웹 페이지의 빠른 렌더링에 좋고, 쿠키와 세션은 사용자의 인증에 도움을 줍니다.

#### 캐시의 특징

캐시는 이미지, 비디오, 오디오, css, js파일 등 데이터나 값을 미리 복사해 놓는 리소스 파일들의 임시 저장소입니다.<br>
저장 공간이 작고 비용이 비싸지만 빠른 성능을 제공합니다.<br>
같은 웹 페이지에 접속할 때 서버를 거치지 않고 로컬 PC에서 데이터를 가져옵니다.<br>
다시 사용될 확률이 있는 데이터들을 캐시에 적재하여 빠르게 접근할 수 있습니다. (페이지의 로딩 속도 증가)<br>

<br>
<br>

> **참고**<br> [https://velog.io/@stay136/%EA%B8%B0%EC%88%A0-%EC%BF%A0%ED%82%A4%EC%99%80-%EC%84%B8%EC%85%98%EC%9D%98-%EC%B0%A8%EC%9D%B4](https://velog.io/@stay136/%EA%B8%B0%EC%88%A0-%EC%BF%A0%ED%82%A4%EC%99%80-%EC%84%B8%EC%85%98%EC%9D%98-%EC%B0%A8%EC%9D%B4)<br> [https://jeong-pro.tistory.com/80](https://jeong-pro.tistory.com/80)<br> [https://devuna.tistory.com/23](https://devuna.tistory.com/23)<br> [https://dev-coco.tistory.com/61](https://dev-coco.tistory.com/61)
